# Causal Deep Video Inpainting
This repository holds the code and visualizations of the results for my final project for Digital Video. The causal model in this repo is built on top of the non-causal model outlined in Deep Flow-Guided Video Inpainting by Xu et al. The paper can be found [here](https://arxiv.org/abs/1905.02884) and the original repository can be found [here](https://github.com/nbei/Deep-Flow-Guided-Video-Inpainting/tree/v1.1). The code for branch v1.1 of their repo is copied in the initial commit of this repo and modified as part of the project.



## Report
The report can be found [here](https://github.com/mstecklein/DigitalVideoFinalProject/blob/master/report/Digital_Video_Final_Project_Report.pdf).



## Retrained Models
The transfer learned retrained models can be found [here](https://drive.google.com/drive/folders/1wqIfTR_IQ7v5tfrPZnojjee4yu3KmJdj).



## Visualizations of Results
Below are various visualizations of the results of the project. The visualizations are all referenced and analyzed in the project report.

### Video Inpainting Results
The following are the video inpainting outputs for 3 videos from the DAVIS dataset. The top-left is the original video, the top-right is each frame inpainted by the image inpainting model of Yu et al., the bottom-left is the non-causal model of Xu et al., and the bottom-right is my causal model.
<img src="https://github.com/mstecklein/DigitalVideoFinalProject/blob/master/visualizations/full_video_inpainting_flamingo.gif" width="850"/>
<img src="https://github.com/mstecklein/DigitalVideoFinalProject/blob/master/visualizations/full_video_inpainting_ladyrunning.gif" width="850"/>
<img src="https://github.com/mstecklein/DigitalVideoFinalProject/blob/master/visualizations/full_video_inpainting_spiderman.gif" width="850"/>

### Video Inpainting, Flow Propagation Only
The following are the video inpainting outputs for the same 3 videos from the DAVIS dataset, where inpainting is achieved only by propagating pixels using the completed flow fields. In other words,  in the post-processing step, any pixels that are not filled in by flow prop-agation are left black rather than inpainting them with the image  inpainting  model. The top-left is the original video, the top-right is the original video with the mask overlayed in red, the bottom-left is the non-causal model of Xu et al., and the bottom-right is my causal model.
<img src="https://github.com/mstecklein/DigitalVideoFinalProject/blob/master/visualizations/flow_inpaint_only_flamingo.gif" width="850"/>
<img src="https://github.com/mstecklein/DigitalVideoFinalProject/blob/master/visualizations/flow_inpaint_only_ladyrunning.gif" width="850"/>
<img src="https://github.com/mstecklein/DigitalVideoFinalProject/blob/master/visualizations/flow_inpaint_only_spiderman.gif" width="850"/>

### Flow Fields
The following are the flow fields for the same 3 videos from the DAVIS dataset. The left flow is the "true" flow generated by FlowNet 2.0, the middle is the completed flow generated by the non-causal model of Xu et al., and the right is the completed flow generated by my causal model.
<img src="https://github.com/mstecklein/DigitalVideoFinalProject/blob/master/visualizations/true_orig_causal_flows_flamingo.gif" width="850"/>
<img src="https://github.com/mstecklein/DigitalVideoFinalProject/blob/master/visualizations/true_orig_causal_flows_ladyrunning.gif" width="850"/>
<img src="https://github.com/mstecklein/DigitalVideoFinalProject/blob/master/visualizations/true_orig_causal_flows_spiderman.gif" width="850"/>
